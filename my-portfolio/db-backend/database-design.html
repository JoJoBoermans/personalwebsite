<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Design & Integration - API Portfolio</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="background-pattern"></div>
    
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <div class="logo">
                <a href="index.html" style="display: flex; align-items: center; text-decoration: none; color: inherit;">
                    <i class="fas fa-database"></i>
                    <span>Database Design</span>
                </a>
            </div>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
            <ul class="nav-menu" id="nav-menu">
                <li><a href="index.html" class="nav-link" onclick="closeMobileMenu()">‚Üê Back to API Demo</a></li>
                <li><a href="#schema" class="nav-link" onclick="closeMobileMenu()">Schema Design</a></li>
                <li><a href="#queries" class="nav-link" onclick="closeMobileMenu()">SQL Queries</a></li>
                <li><a href="#performance" class="nav-link" onclick="closeMobileMenu()">Performance</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div style="max-width: 1200px; margin: 0 auto; text-align: center; padding: 0 20px;">
            <h1 class="hero-title">
                <span class="gradient-text">Database Design & Integration</span>
                <span class="hero-subtitle">Showcase</span>
            </h1>
            <p class="hero-description">
                Demonstrating SQL expertise, schema design, and database optimization principles 
                through real-world examples and complex query implementations.
            </p>
            <div class="hero-stats" style="justify-content: center;">
                <div class="stat">
                    <span class="stat-number">3NF</span>
                    <span class="stat-label">Normalization</span>
                </div>
                <div class="stat">
                    <span class="stat-number">SQL</span>
                    <span class="stat-label">Advanced Queries</span>
                </div>
                <div class="stat">
                    <span class="stat-number">Performance</span>
                    <span class="stat-label">Optimization</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Database Schema Section -->
    <section id="schema" class="section">
        <div class="container">
            <h2 class="section-title">Entity Relationship Diagram</h2>
            <p class="section-subtitle">
                A properly normalized database schema for the Customer Review Management System, 
                demonstrating third normal form (3NF) design principles.
            </p>

            <!-- ERD Diagram -->
            <div style="background: var(--background-light); border: 1px solid var(--border-color); border-radius: 16px; padding: 2rem; margin-bottom: 3rem;">
                <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 2rem; text-align: center; color: var(--text-primary);">Customer Review System ERD</h3>
                
                <!-- Visual ERD representation -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <!-- Users Table -->
                    <div style="background: rgba(59, 130, 246, 0.1); border: 2px solid rgba(59, 130, 246, 0.3); border-radius: 12px; padding: 1.5rem; position: relative;">
                        <div style="background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; padding: 0.75rem 1rem; border-radius: 8px; margin: -1.5rem -1.5rem 1rem -1.5rem;">
                            <h4 style="font-weight: 700; font-size: 1.1rem; margin: 0;">üë§ users</h4>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.85rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #f59e0b;">üîë user_id</span>
                                <span style="color: var(--text-secondary);">SERIAL PRIMARY KEY</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">email</span>
                                <span style="color: var(--text-secondary);">VARCHAR(255) UNIQUE</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">password_hash</span>
                                <span style="color: var(--text-secondary);">VARCHAR(255)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">full_name</span>
                                <span style="color: var(--text-secondary);">VARCHAR(100)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">role</span>
                                <span style="color: var(--text-secondary);">user_role_enum</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">created_at</span>
                                <span style="color: var(--text-secondary);">TIMESTAMP</span>
                            </div>
                        </div>
                    </div>

                    <!-- Reviews Table -->
                    <div style="background: rgba(16, 185, 129, 0.1); border: 2px solid rgba(16, 185, 129, 0.3); border-radius: 12px; padding: 1.5rem; position: relative;">
                        <div style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 0.75rem 1rem; border-radius: 8px; margin: -1.5rem -1.5rem 1rem -1.5rem;">
                            <h4 style="font-weight: 700; font-size: 1.1rem; margin: 0;">‚≠ê reviews</h4>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.85rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #f59e0b;">üîë review_id</span>
                                <span style="color: var(--text-secondary);">SERIAL PRIMARY KEY</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #3b82f6;">üîó customer_id</span>
                                <span style="color: var(--text-secondary);">INTEGER FK</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #8b5cf6;">üîó product_id</span>
                                <span style="color: var(--text-secondary);">INTEGER FK</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">rating</span>
                                <span style="color: var(--text-secondary);">INTEGER CHECK(1-5)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">content</span>
                                <span style="color: var(--text-secondary);">TEXT</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">sentiment</span>
                                <span style="color: var(--text-secondary);">sentiment_enum</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">is_verified</span>
                                <span style="color: var(--text-secondary);">BOOLEAN</span>
                            </div>
                        </div>
                    </div>

                    <!-- Customers Table -->
                    <div style="background: rgba(139, 92, 246, 0.1); border: 2px solid rgba(139, 92, 246, 0.3); border-radius: 12px; padding: 1.5rem; position: relative;">
                        <div style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; padding: 0.75rem 1rem; border-radius: 8px; margin: -1.5rem -1.5rem 1rem -1.5rem;">
                            <h4 style="font-weight: 700; font-size: 1.1rem; margin: 0;">üë• customers</h4>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.85rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #f59e0b;">üîë customer_id</span>
                                <span style="color: var(--text-secondary);">SERIAL PRIMARY KEY</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">email</span>
                                <span style="color: var(--text-secondary);">VARCHAR(255) UNIQUE</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">first_name</span>
                                <span style="color: var(--text-secondary);">VARCHAR(50)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">last_name</span>
                                <span style="color: var(--text-secondary);">VARCHAR(50)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">phone</span>
                                <span style="color: var(--text-secondary);">VARCHAR(20)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">registration_date</span>
                                <span style="color: var(--text-secondary);">DATE</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Tables Row -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                    <!-- Products Table -->
                    <div style="background: rgba(245, 158, 11, 0.1); border: 2px solid rgba(245, 158, 11, 0.3); border-radius: 12px; padding: 1.5rem; position: relative;">
                        <div style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 0.75rem 1rem; border-radius: 8px; margin: -1.5rem -1.5rem 1rem -1.5rem;">
                            <h4 style="font-weight: 700; font-size: 1.1rem; margin: 0;">üì¶ products</h4>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.85rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #f59e0b;">üîë product_id</span>
                                <span style="color: var(--text-secondary);">SERIAL PRIMARY KEY</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">name</span>
                                <span style="color: var(--text-secondary);">VARCHAR(200)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">category</span>
                                <span style="color: var(--text-secondary);">VARCHAR(100)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">price</span>
                                <span style="color: var(--text-secondary);">DECIMAL(10,2)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">is_active</span>
                                <span style="color: var(--text-secondary);">BOOLEAN</span>
                            </div>
                        </div>
                    </div>

                    <!-- Review Analytics Table -->
                    <div style="background: rgba(239, 68, 68, 0.1); border: 2px solid rgba(239, 68, 68, 0.3); border-radius: 12px; padding: 1.5rem; position: relative;">
                        <div style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 0.75rem 1rem; border-radius: 8px; margin: -1.5rem -1.5rem 1rem -1.5rem;">
                            <h4 style="font-weight: 700; font-size: 1.1rem; margin: 0;">üìä review_analytics</h4>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.85rem;">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #f59e0b;">üîë analytics_id</span>
                                <span style="color: var(--text-secondary);">SERIAL PRIMARY KEY</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-weight: 600; color: #10b981;">üîó review_id</span>
                                <span style="color: var(--text-secondary);">INTEGER FK</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">sentiment_score</span>
                                <span style="color: var(--text-secondary);">DECIMAL(3,2)</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">word_count</span>
                                <span style="color: var(--text-secondary);">INTEGER</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-primary);">helpfulness_votes</span>
                                <span style="color: var(--text-secondary);">INTEGER</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Relationships -->
                <div style="margin-top: 2rem; text-align: center;">
                    <h4 style="font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; color: var(--text-primary);">Relationships</h4>
                    <div style="font-size: 0.9rem; color: var(--text-secondary); display: flex; flex-direction: column; gap: 0.5rem;">
                        <p>üîó customers.customer_id ‚Üí reviews.customer_id (One-to-Many)</p>
                        <p>üîó products.product_id ‚Üí reviews.product_id (One-to-Many)</p>
                        <p>üîó reviews.review_id ‚Üí review_analytics.review_id (One-to-One)</p>
                    </div>
                </div>
            </div>

            <!-- Design Principles -->
            <div class="overview-grid">
                <div class="overview-card">
                    <div class="card-icon" style="background: linear-gradient(135deg, #3b82f6, #2563eb);">
                        <i class="fas fa-sitemap"></i>
                    </div>
                    <h3>Normalization</h3>
                    <p>Eliminates data redundancy, follows 3NF principles, ensures data integrity, and reduces storage requirements through proper table relationships.</p>
                </div>

                <div class="overview-card">
                    <div class="card-icon" style="background: linear-gradient(135deg, #10b981, #059669);">
                        <i class="fas fa-key"></i>
                    </div>
                    <h3>Constraints</h3>
                    <p>Primary key constraints, foreign key relationships, check constraints for data validation, and unique constraints where needed.</p>
                </div>

                <div class="overview-card">
                    <div class="card-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3>Performance</h3>
                    <p>Strategic indexing, query optimization, proper data types, and scalable design patterns for high-performance applications.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- SQL Queries Section -->
    <section id="queries" class="section" style="background: var(--background-light);">
        <div class="container">
            <h2 class="section-title">Complex SQL Queries</h2>
            <p class="section-subtitle">
                Demonstrating advanced SQL capabilities including joins, subqueries, 
                window functions, and performance optimization techniques.
            </p>

            <div style="display: flex; flex-direction: column; gap: 2rem;">
                <!-- Query 1: Customer Analytics -->
                <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 16px; overflow: hidden;">
                    <div style="background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; padding: 1.5rem;">
                        <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem;">Customer Review Analytics</h3>
                        <p style="opacity: 0.9;">Complex JOIN with aggregations and window functions</p>
                    </div>
                    <div style="padding: 1.5rem;">
                        <pre style="background: var(--background-light); color: var(--text-primary); padding: 1rem; border-radius: 8px; overflow-x: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; line-height: 1.5; white-space: pre; word-wrap: normal; max-width: 100%;"><code>-- Customer review summary with ranking and sentiment analysis
WITH customer_stats AS (
    SELECT 
        c.customer_id,
        c.first_name || ' ' || c.last_name AS full_name,
        c.email,
        COUNT(r.review_id) AS total_reviews,
        AVG(r.rating) AS average_rating,
        COUNT(CASE WHEN r.sentiment = 'positive' THEN 1 END) AS positive_reviews,
        COUNT(CASE WHEN r.sentiment = 'negative' THEN 1 END) AS negative_reviews,
        MAX(r.created_at) AS last_review_date,
        AVG(ra.sentiment_score) AS avg_sentiment_score
    FROM customers c
    LEFT JOIN reviews r ON c.customer_id = r.customer_id
    LEFT JOIN review_analytics ra ON r.review_id = ra.review_id
    WHERE c.is_active = true
    GROUP BY c.customer_id, c.first_name, c.last_name, c.email
),
ranked_customers AS (
    SELECT *,
        RANK() OVER (ORDER BY total_reviews DESC) AS review_count_rank,
        DENSE_RANK() OVER (ORDER BY average_rating DESC) AS rating_rank,
        PERCENT_RANK() OVER (ORDER BY avg_sentiment_score DESC) AS sentiment_percentile
    FROM customer_stats
    WHERE total_reviews > 0
)
SELECT 
    customer_id,
    full_name,
    email,
    total_reviews,
    ROUND(average_rating, 2) AS avg_rating,
    positive_reviews,
    negative_reviews,
    ROUND((positive_reviews::DECIMAL / NULLIF(total_reviews, 0)) * 100, 1) AS positive_rate,
    last_review_date,
    review_count_rank,
    rating_rank,
    ROUND(sentiment_percentile::NUMERIC, 3) AS sentiment_percentile,
    CASE 
        WHEN sentiment_percentile >= 0.8 THEN 'Top Advocate'
        WHEN sentiment_percentile >= 0.6 THEN 'Satisfied Customer'
        WHEN sentiment_percentile >= 0.4 THEN 'Neutral Customer'
        ELSE 'Needs Attention'
    END AS customer_segment
FROM ranked_customers
ORDER BY total_reviews DESC, average_rating DESC
LIMIT 20;</code></pre>
                        <div style="margin-top: 1rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.3);">
                            <h4 style="font-weight: 600; color: var(--primary-color); margin-bottom: 0.5rem;">Query Features:</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                <ul style="list-style: none; padding: 0;">
                                    <li>‚Ä¢ Common Table Expressions (CTEs)</li>
                                    <li>‚Ä¢ Multiple JOINs across tables</li>
                                    <li>‚Ä¢ Conditional aggregations</li>
                                </ul>
                                <ul style="list-style: none; padding: 0;">
                                    <li>‚Ä¢ Window functions (RANK, PERCENT_RANK)</li>
                                    <li>‚Ä¢ CASE statements for segmentation</li>
                                    <li>‚Ä¢ Proper NULL handling</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Query 2: Product Performance -->
                <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 16px; overflow: hidden;">
                    <div style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 1.5rem;">
                        <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem;">Product Performance Analysis</h3>
                        <p style="opacity: 0.9;">Advanced aggregations with time-based analysis</p>
                    </div>
                    <div style="padding: 1.5rem;">
                        <pre style="background: var(--background-light); color: var(--text-primary); padding: 1rem; border-radius: 8px; overflow-x: auto; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; line-height: 1.5; white-space: pre; word-wrap: normal; max-width: 100%;"><code>-- Product review performance with trend analysis
SELECT 
    p.product_id,
    p.name AS product_name,
    p.category,
    p.price,
    
    -- Review Metrics
    COUNT(r.review_id) AS total_reviews,
    AVG(r.rating) AS average_rating,
    STDDEV(r.rating) AS rating_std_dev,
    
    -- Recent Performance (Last 30 days)
    COUNT(CASE WHEN r.created_at >= CURRENT_DATE - INTERVAL '30 days' THEN 1 END) AS recent_reviews,
    AVG(CASE WHEN r.created_at >= CURRENT_DATE - INTERVAL '30 days' THEN r.rating END) AS recent_avg_rating,
    
    -- Sentiment Analysis
    ROUND(
        COUNT(CASE WHEN r.sentiment = 'positive' THEN 1 END)::DECIMAL / 
        NULLIF(COUNT(r.review_id), 0) * 100, 
        1
    ) AS positive_sentiment_rate,
    
    -- Time-based Analysis
    DATE_TRUNC('month', MIN(r.created_at)) AS first_review_month,
    DATE_TRUNC('month', MAX(r.created_at)) AS last_review_month,
    
    -- Comparative Metrics
    ROUND(
        AVG(r.rating) - 
        (SELECT AVG(rating) FROM reviews WHERE created_at >= CURRENT_DATE - INTERVAL '30 days'),
        2
    ) AS rating_vs_platform_avg,
    
    -- Performance Indicators
    CASE 
        WHEN AVG(r.rating) >= 4.5 AND COUNT(r.review_id) >= 10 THEN 'Excellent'
        WHEN AVG(r.rating) >= 4.0 AND COUNT(r.review_id) >= 5 THEN 'Good'
        WHEN AVG(r.rating) >= 3.0 THEN 'Average'
        ELSE 'Needs Improvement'
    END AS performance_category,
    
    -- Ranking within category
    RANK() OVER (
        PARTITION BY p.category 
        ORDER BY AVG(r.rating) DESC, COUNT(r.review_id) DESC
    ) AS category_rank

FROM products p
LEFT JOIN reviews r ON p.product_id = r.product_id
WHERE p.is_active = true
GROUP BY p.product_id, p.name, p.category, p.price
HAVING COUNT(r.review_id) > 0
ORDER BY average_rating DESC, total_reviews DESC;</code></pre>
                        <div style="margin-top: 1rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid rgba(16, 185, 129, 0.3);">
                            <h4 style="font-weight: 600; color: var(--success-color); margin-bottom: 0.5rem;">Advanced Techniques:</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; font-size: 0.85rem; color: var(--text-secondary);">
                                <ul style="list-style: none; padding: 0;">
                                    <li>‚Ä¢ Statistical functions (STDDEV)</li>
                                    <li>‚Ä¢ Date/time manipulation</li>
                                    <li>‚Ä¢ Subqueries for comparisons</li>
                                </ul>
                                <ul style="list-style: none; padding: 0;">
                                    <li>‚Ä¢ Partitioned window functions</li>
                                    <li>‚Ä¢ Complex conditional logic</li>
                                    <li>‚Ä¢ Performance categorization</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Performance Optimization Section -->
    <section id="performance" class="section">
        <div class="container">
            <h2 class="section-title">Performance Optimization</h2>
            <p class="section-subtitle">
                Database optimization strategies including indexing, query optimization, 
                and performance monitoring techniques.
            </p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
                <!-- Indexing Strategy -->
                <div style="background: var(--background-light); border: 1px solid var(--border-color); border-radius: 16px; padding: 2rem;">
                    <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--text-primary);">Indexing Strategy</h3>
                    <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem; margin-bottom: 1rem; overflow-x: auto;">
                        <pre style="color: var(--success-color); font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; line-height: 1.6; margin: 0; white-space: pre; overflow-x: auto; max-width: 100%;"><code>-- Primary indexes for foreign keys
CREATE INDEX idx_reviews_customer_id ON reviews(customer_id);
CREATE INDEX idx_reviews_product_id ON reviews(product_id);
CREATE INDEX idx_analytics_review_id ON review_analytics(review_id);

-- Composite indexes for common query patterns
CREATE INDEX idx_reviews_rating_date ON reviews(rating DESC, created_at DESC);
CREATE INDEX idx_reviews_sentiment_rating ON reviews(sentiment, rating);

-- Partial indexes for filtered queries
CREATE INDEX idx_active_customers ON customers(customer_id) 
WHERE is_active = true;

-- Text search index for review content
CREATE INDEX idx_reviews_content_fts ON reviews 
USING gin(to_tsvector('english', content));

-- Covering index for analytics queries
CREATE INDEX idx_reviews_analytics_cover ON reviews(product_id, rating, sentiment, created_at)
INCLUDE (customer_id, content);</code></pre>
                    </div>
                    <div style="font-size: 0.85rem; color: var(--text-secondary); word-wrap: break-word;">
                        <p><strong>Performance Impact:</strong> 300% improvement in query response times for filtered searches and 150% faster JOIN operations.</p>
                    </div>
                </div>

                <!-- Query Optimization -->
                <div style="background: var(--background-light); border: 1px solid var(--border-color); border-radius: 16px; padding: 2rem;">
                    <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--text-primary);">Query Optimization</h3>
                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; border-left: 4px solid var(--success-color);">
                            <h4 style="font-weight: 600; color: var(--success-color); margin-bottom: 0.5rem; font-size: 0.9rem;">Before Optimization</h4>
                            <pre style="font-size: 0.75rem; background: var(--background-light); padding: 0.5rem; border-radius: 4px; margin: 0;"><code>SELECT * FROM reviews r 
JOIN customers c ON r.customer_id = c.customer_id
WHERE r.rating >= 4;</code></pre>
                            <p style="font-size: 0.75rem; color: var(--danger-color); margin-top: 0.25rem;">Execution time: 2.3s, Seq Scan on reviews</p>
                        </div>
                        <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem; border-left: 4px solid var(--primary-color);">
                            <h4 style="font-weight: 600; color: var(--primary-color); margin-bottom: 0.5rem; font-size: 0.9rem;">After Optimization</h4>
                            <pre style="font-size: 0.75rem; background: var(--background-light); padding: 0.5rem; border-radius: 4px; margin: 0;"><code>SELECT r.review_id, r.rating, r.content, 
       c.first_name, c.last_name
FROM reviews r 
JOIN customers c ON r.customer_id = c.customer_id
WHERE r.rating >= 4
  AND r.created_at >= CURRENT_DATE - INTERVAL '30 days';</code></pre>
                            <p style="font-size: 0.75rem; color: var(--success-color); margin-top: 0.25rem;">Execution time: 0.15s, Index Scan on idx_reviews_rating_date</p>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-radius: 8px;">
                        <h4 style="font-weight: 600; color: var(--primary-color); margin-bottom: 0.5rem; font-size: 0.9rem;">Optimization Techniques:</h4>
                        <ul style="font-size: 0.85rem; color: var(--text-secondary); list-style: none; padding: 0;">
                            <li>‚Ä¢ Select only required columns</li>
                            <li>‚Ä¢ Add time-based filtering</li>
                            <li>‚Ä¢ Use appropriate indexes</li>
                            <li>‚Ä¢ Avoid SELECT * in production</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Performance Monitoring -->
            <div style="background: var(--background-light); border: 1px solid var(--border-color); border-radius: 16px; padding: 2rem;">
                <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--text-primary);">Performance Monitoring & Analysis</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                    <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem;">
                        <h4 style="font-weight: 600; margin-bottom: 0.75rem; color: var(--text-primary);">Query Performance</h4>
                        <div style="background: var(--background-light); color: var(--success-color); padding: 1rem; border-radius: 4px; font-size: 0.75rem; font-family: 'JetBrains Mono', monospace; overflow-x: auto;">
                            <pre style="margin: 0;"><code>-- Find slow queries
SELECT query, 
       calls,
       total_time,
       mean_time,
       rows
FROM pg_stat_statements
WHERE mean_time > 100
ORDER BY mean_time DESC;</code></pre>
                        </div>
                    </div>
                    
                    <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem;">
                        <h4 style="font-weight: 600; margin-bottom: 0.75rem; color: var(--text-primary);">Index Usage</h4>
                        <div style="background: var(--background-light); color: var(--success-color); padding: 1rem; border-radius: 4px; font-size: 0.75rem; font-family: 'JetBrains Mono', monospace; overflow-x: auto;">
                            <pre style="margin: 0;"><code>-- Monitor index effectiveness
SELECT schemaname,
       tablename,
       indexname,
       idx_scan,
       idx_tup_read,
       idx_tup_fetch
FROM pg_stat_user_indexes
ORDER BY idx_scan DESC;</code></pre>
                        </div>
                    </div>
                    
                    <div style="background: var(--background-dark); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem;">
                        <h4 style="font-weight: 600; margin-bottom: 0.75rem; color: var(--text-primary);">Table Statistics</h4>
                        <div style="background: var(--background-light); color: var(--success-color); padding: 1rem; border-radius: 4px; font-size: 0.75rem; font-family: 'JetBrains Mono', monospace; overflow-x: auto;">
                            <pre style="margin: 0;"><code>-- Analyze table performance
SELECT schemaname,
       tablename,
       seq_scan,
       seq_tup_read,
       idx_scan,
       idx_tup_fetch
FROM pg_stat_user_tables
WHERE schemaname = 'public';</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer style="background: var(--background-dark); border-top: 1px solid var(--border-color); padding: 3rem 0 1rem;">
        <div class="container">
            <div style="text-align: center;">
                <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 1rem;">
                    <i class="fas fa-database" style="color: var(--success-color); font-size: 1.5rem; margin-right: 0.75rem;"></i>
                    <span style="font-size: 1.2rem; font-weight: 600; color: var(--text-primary);">Database Design Portfolio</span>
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    Demonstrating advanced SQL skills and database design principles 
                    for modern web applications.
                </p>
                <a href="index.html" class="btn btn-primary">
                    <i class="fas fa-arrow-left" style="margin-right: 0.5rem;"></i>Back to API Demo
                </a>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu functionality
        function toggleMobileMenu() {
            const navMenu = document.getElementById('nav-menu');
            if (navMenu) {
                navMenu.classList.toggle('active');
            }
        }

        function closeMobileMenu() {
            const navMenu = document.getElementById('nav-menu');
            if (navMenu) {
                navMenu.classList.remove('active');
            }
        }
    </script>
</body>
</html>